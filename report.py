#####################################################################################
#                                                                                   #
#       README      README      README      README      README      README          #
#                                                                                   #
#-----------------------------------------------------------------------------------#
#                                                                                   #
#       This script's purpose is to generate reports on Kibana so the user can      #
#       download them in Management>Reporting section with ".csv" format            # 
#       using Kibana API and curl commands.                                         #
#       All the reports targets the logs for one day ago, if one parameter          #
#       (time range, filters, ...) of already saved configurations                  #
#       is changed, a new url needs to be pasted                                    #
#                                                                                   #
#####################################################################################


if __name__ == "__main__":
    import os
    import json

    # Parameters to for the curl command -u *user:password" H *kibana version*
    params = ' -u kibanaadmin:azerty -H \'kbn-version: 7.6.1\' '

    # Genraration of the report using Errors: MultiChainMiner
    ErrorsMCM_report_url = "'http://172.30.10.12/api/reporting/generate/csv?jobParams=(conflictedTypesFields:!(),fields:!(%27@timestamp%27,%27@version%27,_id,_index,_score,_type,agent.ephemeral_id,agent.hostname,agent.id,agent.type,agent.version,ecs.version,err_type,filename,host.name,input.type,label,log.file.path,log.offset,message,recv-date,recv-time,recv-timestamp,suricata.eve.timestamp,tags),indexPatternId:%279a6c4830-ed47-11ea-9640-a9f74e0dd150%27,metaFields:!(_source,_id,_type,_index,_score),searchRequest:(body:(_source:(excludes:!()),docvalue_fields:!((field:%27@timestamp%27,format:date_time),(field:aws.cloudtrail.user_identity.session_context.creation_date,format:date_time),(field:azure.auditlogs.properties.activity_datetime,format:date_time),(field:azure.enqueued_time,format:date_time),(field:azure.signinlogs.properties.created_at,format:date_time),(field:cef.extensions.agentReceiptTime,format:date_time),(field:cef.extensions.deviceCustomDate1,format:date_time),(field:cef.extensions.deviceCustomDate2,format:date_time),(field:cef.extensions.deviceReceiptTime,format:date_time),(field:cef.extensions.endTime,format:date_time),(field:cef.extensions.fileCreateTime,format:date_time),(field:cef.extensions.fileModificationTime,format:date_time),(field:cef.extensions.flexDate1,format:date_time),(field:cef.extensions.managerReceiptTime,format:date_time),(field:cef.extensions.oldFileCreateTime,format:date_time),(field:cef.extensions.oldFileModificationTime,format:date_time),(field:cef.extensions.startTime,format:date_time),(field:event.created,format:date_time),(field:event.end,format:date_time),(field:event.ingested,format:date_time),(field:event.start,format:date_time),(field:file.accessed,format:date_time),(field:file.created,format:date_time),(field:file.ctime,format:date_time),(field:file.mtime,format:date_time),(field:kafka.block_timestamp,format:date_time),(field:misp.campaign.first_seen,format:date_time),(field:misp.campaign.last_seen,format:date_time),(field:misp.intrusion_set.first_seen,format:date_time),(field:misp.intrusion_set.last_seen,format:date_time),(field:misp.observed_data.first_observed,format:date_time),(field:misp.observed_data.last_observed,format:date_time),(field:misp.report.published,format:date_time),(field:misp.threat_indicator.valid_from,format:date_time),(field:misp.threat_indicator.valid_until,format:date_time),(field:netflow.collection_time_milliseconds,format:date_time),(field:netflow.exporter.timestamp,format:date_time),(field:netflow.flow_end_microseconds,format:date_time),(field:netflow.flow_end_milliseconds,format:date_time),(field:netflow.flow_end_nanoseconds,format:date_time),(field:netflow.flow_end_seconds,format:date_time),(field:netflow.flow_start_microseconds,format:date_time),(field:netflow.flow_start_milliseconds,format:date_time),(field:netflow.flow_start_nanoseconds,format:date_time),(field:netflow.flow_start_seconds,format:date_time),(field:netflow.max_export_seconds,format:date_time),(field:netflow.max_flow_end_microseconds,format:date_time),(field:netflow.max_flow_end_milliseconds,format:date_time),(field:netflow.max_flow_end_nanoseconds,format:date_time),(field:netflow.max_flow_end_seconds,format:date_time),(field:netflow.min_export_seconds,format:date_time),(field:netflow.min_flow_start_microseconds,format:date_time),(field:netflow.min_flow_start_milliseconds,format:date_time),(field:netflow.min_flow_start_nanoseconds,format:date_time),(field:netflow.min_flow_start_seconds,format:date_time),(field:netflow.monitoring_interval_end_milli_seconds,format:date_time),(field:netflow.monitoring_interval_start_milli_seconds,format:date_time),(field:netflow.observation_time_microseconds,format:date_time),(field:netflow.observation_time_milliseconds,format:date_time),(field:netflow.observation_time_nanoseconds,format:date_time),(field:netflow.observation_time_seconds,format:date_time),(field:netflow.system_init_time_milliseconds,format:date_time),(field:package.installed,format:date_time),(field:process.parent.start,format:date_time),(field:process.start,format:date_time),(field:suricata.eve.flow.end,format:date_time),(field:suricata.eve.flow.start,format:date_time),(field:suricata.eve.timestamp,format:date_time),(field:suricata.eve.tls.notafter,format:date_time),(field:suricata.eve.tls.notbefore,format:date_time),(field:tls.client.not_after,format:date_time),(field:tls.client.not_before,format:date_time),(field:tls.server.not_after,format:date_time),(field:tls.server.not_before,format:date_time),(field:zeek.kerberos.valid.from,format:date_time),(field:zeek.kerberos.valid.until,format:date_time),(field:zeek.ocsp.revoke.time,format:date_time),(field:zeek.ocsp.update.next,format:date_time),(field:zeek.ocsp.update.this,format:date_time),(field:zeek.pe.compile_time,format:date_time),(field:zeek.smb_files.times.accessed,format:date_time),(field:zeek.smb_files.times.changed,format:date_time),(field:zeek.smb_files.times.created,format:date_time),(field:zeek.smb_files.times.modified,format:date_time),(field:zeek.smtp.date,format:date_time),(field:zeek.snmp.up_since,format:date_time),(field:zeek.x509.certificate.valid.from,format:date_time),(field:zeek.x509.certificate.valid.until,format:date_time)),query:(bool:(filter:!((match_all:()),(exists:(field:err_type)),(match_phrase:(label:MultiChainMiner)),(range:(%27@timestamp%27:(format:strict_date_optional_time,gte:%272020-09-04T20:57:34.099Z%27,lte:%272020-09-05T20:57:34.100Z%27)))),must:!(),must_not:!(),should:!())),script_fields:(),sort:!((%27@timestamp%27:(order:desc,unmapped_type:boolean))),stored_fields:!(%27*%27),version:!t),index:%27filebeat*%27),title:%27Errors:%20MultiChainMiner%27,type:search)'"
    os.system('curl -X POST' + params + ErrorsMCM_report_url)

    # Genraration of the report using Errors: Others
    ErrorsOthers_report_url = "'http://172.30.10.12/api/reporting/generate/csv?jobParams=(conflictedTypesFields:!(),fields:!(%27@timestamp%27,%27@version%27,_id,_index,_score,_type,agent.ephemeral_id,agent.hostname,agent.id,agent.type,agent.version,block_id,ecs.version,err_type,filename,host.name,input.type,log.file.path,log.offset,message,recv-date,recv-time,recv-timestamp,suricata.eve.timestamp,tags),indexPatternId:%279a6c4830-ed47-11ea-9640-a9f74e0dd150%27,metaFields:!(_source,_id,_type,_index,_score),searchRequest:(body:(_source:(excludes:!()),docvalue_fields:!((field:%27@timestamp%27,format:date_time),(field:aws.cloudtrail.user_identity.session_context.creation_date,format:date_time),(field:azure.auditlogs.properties.activity_datetime,format:date_time),(field:azure.enqueued_time,format:date_time),(field:azure.signinlogs.properties.created_at,format:date_time),(field:cef.extensions.agentReceiptTime,format:date_time),(field:cef.extensions.deviceCustomDate1,format:date_time),(field:cef.extensions.deviceCustomDate2,format:date_time),(field:cef.extensions.deviceReceiptTime,format:date_time),(field:cef.extensions.endTime,format:date_time),(field:cef.extensions.fileCreateTime,format:date_time),(field:cef.extensions.fileModificationTime,format:date_time),(field:cef.extensions.flexDate1,format:date_time),(field:cef.extensions.managerReceiptTime,format:date_time),(field:cef.extensions.oldFileCreateTime,format:date_time),(field:cef.extensions.oldFileModificationTime,format:date_time),(field:cef.extensions.startTime,format:date_time),(field:event.created,format:date_time),(field:event.end,format:date_time),(field:event.ingested,format:date_time),(field:event.start,format:date_time),(field:file.accessed,format:date_time),(field:file.created,format:date_time),(field:file.ctime,format:date_time),(field:file.mtime,format:date_time),(field:kafka.block_timestamp,format:date_time),(field:misp.campaign.first_seen,format:date_time),(field:misp.campaign.last_seen,format:date_time),(field:misp.intrusion_set.first_seen,format:date_time),(field:misp.intrusion_set.last_seen,format:date_time),(field:misp.observed_data.first_observed,format:date_time),(field:misp.observed_data.last_observed,format:date_time),(field:misp.report.published,format:date_time),(field:misp.threat_indicator.valid_from,format:date_time),(field:misp.threat_indicator.valid_until,format:date_time),(field:netflow.collection_time_milliseconds,format:date_time),(field:netflow.exporter.timestamp,format:date_time),(field:netflow.flow_end_microseconds,format:date_time),(field:netflow.flow_end_milliseconds,format:date_time),(field:netflow.flow_end_nanoseconds,format:date_time),(field:netflow.flow_end_seconds,format:date_time),(field:netflow.flow_start_microseconds,format:date_time),(field:netflow.flow_start_milliseconds,format:date_time),(field:netflow.flow_start_nanoseconds,format:date_time),(field:netflow.flow_start_seconds,format:date_time),(field:netflow.max_export_seconds,format:date_time),(field:netflow.max_flow_end_microseconds,format:date_time),(field:netflow.max_flow_end_milliseconds,format:date_time),(field:netflow.max_flow_end_nanoseconds,format:date_time),(field:netflow.max_flow_end_seconds,format:date_time),(field:netflow.min_export_seconds,format:date_time),(field:netflow.min_flow_start_microseconds,format:date_time),(field:netflow.min_flow_start_milliseconds,format:date_time),(field:netflow.min_flow_start_nanoseconds,format:date_time),(field:netflow.min_flow_start_seconds,format:date_time),(field:netflow.monitoring_interval_end_milli_seconds,format:date_time),(field:netflow.monitoring_interval_start_milli_seconds,format:date_time),(field:netflow.observation_time_microseconds,format:date_time),(field:netflow.observation_time_milliseconds,format:date_time),(field:netflow.observation_time_nanoseconds,format:date_time),(field:netflow.observation_time_seconds,format:date_time),(field:netflow.system_init_time_milliseconds,format:date_time),(field:package.installed,format:date_time),(field:process.parent.start,format:date_time),(field:process.start,format:date_time),(field:suricata.eve.flow.end,format:date_time),(field:suricata.eve.flow.start,format:date_time),(field:suricata.eve.timestamp,format:date_time),(field:suricata.eve.tls.notafter,format:date_time),(field:suricata.eve.tls.notbefore,format:date_time),(field:tls.client.not_after,format:date_time),(field:tls.client.not_before,format:date_time),(field:tls.server.not_after,format:date_time),(field:tls.server.not_before,format:date_time),(field:zeek.kerberos.valid.from,format:date_time),(field:zeek.kerberos.valid.until,format:date_time),(field:zeek.ocsp.revoke.time,format:date_time),(field:zeek.ocsp.update.next,format:date_time),(field:zeek.ocsp.update.this,format:date_time),(field:zeek.pe.compile_time,format:date_time),(field:zeek.smb_files.times.accessed,format:date_time),(field:zeek.smb_files.times.changed,format:date_time),(field:zeek.smb_files.times.created,format:date_time),(field:zeek.smb_files.times.modified,format:date_time),(field:zeek.smtp.date,format:date_time),(field:zeek.snmp.up_since,format:date_time),(field:zeek.x509.certificate.valid.from,format:date_time),(field:zeek.x509.certificate.valid.until,format:date_time)),query:(bool:(filter:!((bool:(minimum_should_match:1,should:!((match_phrase:(err_type:%27Tx%20not%20accepted%27))))),(range:(%27@timestamp%27:(format:strict_date_optional_time,gte:%272020-09-04T20:58:28.707Z%27,lte:%272020-09-05T20:58:28.707Z%27)))),must:!(),must_not:!(),should:!())),script_fields:(),sort:!((%27@timestamp%27:(order:desc,unmapped_type:boolean))),stored_fields:!(%27*%27),version:!t),index:%27filebeat*%27),title:%27Errors:%20Others%27,type:search)'"
    os.system('curl -X POST' + params + ErrorsOthers_report_url)

    # Genraration of the report using Errors: ProcessNewBlock
    ErrorsPNB_report_url = "'http://172.30.10.12/api/reporting/generate/csv?jobParams=(conflictedTypesFields:!(),fields:!(),indexPatternId:%279a6c4830-ed47-11ea-9640-a9f74e0dd150%27,metaFields:!(_source,_id,_type,_index,_score),searchRequest:(body:(_source:(excludes:!()),docvalue_fields:!((field:%27@timestamp%27,format:date_time),(field:aws.cloudtrail.user_identity.session_context.creation_date,format:date_time),(field:azure.auditlogs.properties.activity_datetime,format:date_time),(field:azure.enqueued_time,format:date_time),(field:azure.signinlogs.properties.created_at,format:date_time),(field:cef.extensions.agentReceiptTime,format:date_time),(field:cef.extensions.deviceCustomDate1,format:date_time),(field:cef.extensions.deviceCustomDate2,format:date_time),(field:cef.extensions.deviceReceiptTime,format:date_time),(field:cef.extensions.endTime,format:date_time),(field:cef.extensions.fileCreateTime,format:date_time),(field:cef.extensions.fileModificationTime,format:date_time),(field:cef.extensions.flexDate1,format:date_time),(field:cef.extensions.managerReceiptTime,format:date_time),(field:cef.extensions.oldFileCreateTime,format:date_time),(field:cef.extensions.oldFileModificationTime,format:date_time),(field:cef.extensions.startTime,format:date_time),(field:event.created,format:date_time),(field:event.end,format:date_time),(field:event.ingested,format:date_time),(field:event.start,format:date_time),(field:file.accessed,format:date_time),(field:file.created,format:date_time),(field:file.ctime,format:date_time),(field:file.mtime,format:date_time),(field:kafka.block_timestamp,format:date_time),(field:misp.campaign.first_seen,format:date_time),(field:misp.campaign.last_seen,format:date_time),(field:misp.intrusion_set.first_seen,format:date_time),(field:misp.intrusion_set.last_seen,format:date_time),(field:misp.observed_data.first_observed,format:date_time),(field:misp.observed_data.last_observed,format:date_time),(field:misp.report.published,format:date_time),(field:misp.threat_indicator.valid_from,format:date_time),(field:misp.threat_indicator.valid_until,format:date_time),(field:netflow.collection_time_milliseconds,format:date_time),(field:netflow.exporter.timestamp,format:date_time),(field:netflow.flow_end_microseconds,format:date_time),(field:netflow.flow_end_milliseconds,format:date_time),(field:netflow.flow_end_nanoseconds,format:date_time),(field:netflow.flow_end_seconds,format:date_time),(field:netflow.flow_start_microseconds,format:date_time),(field:netflow.flow_start_milliseconds,format:date_time),(field:netflow.flow_start_nanoseconds,format:date_time),(field:netflow.flow_start_seconds,format:date_time),(field:netflow.max_export_seconds,format:date_time),(field:netflow.max_flow_end_microseconds,format:date_time),(field:netflow.max_flow_end_milliseconds,format:date_time),(field:netflow.max_flow_end_nanoseconds,format:date_time),(field:netflow.max_flow_end_seconds,format:date_time),(field:netflow.min_export_seconds,format:date_time),(field:netflow.min_flow_start_microseconds,format:date_time),(field:netflow.min_flow_start_milliseconds,format:date_time),(field:netflow.min_flow_start_nanoseconds,format:date_time),(field:netflow.min_flow_start_seconds,format:date_time),(field:netflow.monitoring_interval_end_milli_seconds,format:date_time),(field:netflow.monitoring_interval_start_milli_seconds,format:date_time),(field:netflow.observation_time_microseconds,format:date_time),(field:netflow.observation_time_milliseconds,format:date_time),(field:netflow.observation_time_nanoseconds,format:date_time),(field:netflow.observation_time_seconds,format:date_time),(field:netflow.system_init_time_milliseconds,format:date_time),(field:package.installed,format:date_time),(field:process.parent.start,format:date_time),(field:process.start,format:date_time),(field:suricata.eve.flow.end,format:date_time),(field:suricata.eve.flow.start,format:date_time),(field:suricata.eve.timestamp,format:date_time),(field:suricata.eve.tls.notafter,format:date_time),(field:suricata.eve.tls.notbefore,format:date_time),(field:tls.client.not_after,format:date_time),(field:tls.client.not_before,format:date_time),(field:tls.server.not_after,format:date_time),(field:tls.server.not_before,format:date_time),(field:zeek.kerberos.valid.from,format:date_time),(field:zeek.kerberos.valid.until,format:date_time),(field:zeek.ocsp.revoke.time,format:date_time),(field:zeek.ocsp.update.next,format:date_time),(field:zeek.ocsp.update.this,format:date_time),(field:zeek.pe.compile_time,format:date_time),(field:zeek.smb_files.times.accessed,format:date_time),(field:zeek.smb_files.times.changed,format:date_time),(field:zeek.smb_files.times.created,format:date_time),(field:zeek.smb_files.times.modified,format:date_time),(field:zeek.smtp.date,format:date_time),(field:zeek.snmp.up_since,format:date_time),(field:zeek.x509.certificate.valid.from,format:date_time),(field:zeek.x509.certificate.valid.until,format:date_time)),query:(bool:(filter:!((match_all:()),(exists:(field:err_type)),(match_phrase:(label:ProcessNewBlock)),(range:(%27@timestamp%27:(format:strict_date_optional_time,gte:%272020-09-04T20:59:28.287Z%27,lte:%272020-09-05T20:59:28.287Z%27)))),must:!(),must_not:!(),should:!())),script_fields:(),sort:!((%27@timestamp%27:(order:desc,unmapped_type:boolean))),stored_fields:!(%27*%27),version:!t),index:%27filebeat*%27),title:%27Errors:%20ProccessNewBlock%27,type:search)'"
    os.system('curl -X POST' + params + ErrorsPNB_report_url)

    # Genraration of the report using Errors: Socket
    ErrorsSocket_report_url = "'http://172.30.10.12/api/reporting/generate/csv?jobParams=(conflictedTypesFields:!(),fields:!(),indexPatternId:%279a6c4830-ed47-11ea-9640-a9f74e0dd150%27,metaFields:!(_source,_id,_type,_index,_score),searchRequest:(body:(_source:(excludes:!()),docvalue_fields:!((field:%27@timestamp%27,format:date_time),(field:aws.cloudtrail.user_identity.session_context.creation_date,format:date_time),(field:azure.auditlogs.properties.activity_datetime,format:date_time),(field:azure.enqueued_time,format:date_time),(field:azure.signinlogs.properties.created_at,format:date_time),(field:cef.extensions.agentReceiptTime,format:date_time),(field:cef.extensions.deviceCustomDate1,format:date_time),(field:cef.extensions.deviceCustomDate2,format:date_time),(field:cef.extensions.deviceReceiptTime,format:date_time),(field:cef.extensions.endTime,format:date_time),(field:cef.extensions.fileCreateTime,format:date_time),(field:cef.extensions.fileModificationTime,format:date_time),(field:cef.extensions.flexDate1,format:date_time),(field:cef.extensions.managerReceiptTime,format:date_time),(field:cef.extensions.oldFileCreateTime,format:date_time),(field:cef.extensions.oldFileModificationTime,format:date_time),(field:cef.extensions.startTime,format:date_time),(field:event.created,format:date_time),(field:event.end,format:date_time),(field:event.ingested,format:date_time),(field:event.start,format:date_time),(field:file.accessed,format:date_time),(field:file.created,format:date_time),(field:file.ctime,format:date_time),(field:file.mtime,format:date_time),(field:kafka.block_timestamp,format:date_time),(field:misp.campaign.first_seen,format:date_time),(field:misp.campaign.last_seen,format:date_time),(field:misp.intrusion_set.first_seen,format:date_time),(field:misp.intrusion_set.last_seen,format:date_time),(field:misp.observed_data.first_observed,format:date_time),(field:misp.observed_data.last_observed,format:date_time),(field:misp.report.published,format:date_time),(field:misp.threat_indicator.valid_from,format:date_time),(field:misp.threat_indicator.valid_until,format:date_time),(field:netflow.collection_time_milliseconds,format:date_time),(field:netflow.exporter.timestamp,format:date_time),(field:netflow.flow_end_microseconds,format:date_time),(field:netflow.flow_end_milliseconds,format:date_time),(field:netflow.flow_end_nanoseconds,format:date_time),(field:netflow.flow_end_seconds,format:date_time),(field:netflow.flow_start_microseconds,format:date_time),(field:netflow.flow_start_milliseconds,format:date_time),(field:netflow.flow_start_nanoseconds,format:date_time),(field:netflow.flow_start_seconds,format:date_time),(field:netflow.max_export_seconds,format:date_time),(field:netflow.max_flow_end_microseconds,format:date_time),(field:netflow.max_flow_end_milliseconds,format:date_time),(field:netflow.max_flow_end_nanoseconds,format:date_time),(field:netflow.max_flow_end_seconds,format:date_time),(field:netflow.min_export_seconds,format:date_time),(field:netflow.min_flow_start_microseconds,format:date_time),(field:netflow.min_flow_start_milliseconds,format:date_time),(field:netflow.min_flow_start_nanoseconds,format:date_time),(field:netflow.min_flow_start_seconds,format:date_time),(field:netflow.monitoring_interval_end_milli_seconds,format:date_time),(field:netflow.monitoring_interval_start_milli_seconds,format:date_time),(field:netflow.observation_time_microseconds,format:date_time),(field:netflow.observation_time_milliseconds,format:date_time),(field:netflow.observation_time_nanoseconds,format:date_time),(field:netflow.observation_time_seconds,format:date_time),(field:netflow.system_init_time_milliseconds,format:date_time),(field:package.installed,format:date_time),(field:process.parent.start,format:date_time),(field:process.start,format:date_time),(field:suricata.eve.flow.end,format:date_time),(field:suricata.eve.flow.start,format:date_time),(field:suricata.eve.timestamp,format:date_time),(field:suricata.eve.tls.notafter,format:date_time),(field:suricata.eve.tls.notbefore,format:date_time),(field:tls.client.not_after,format:date_time),(field:tls.client.not_before,format:date_time),(field:tls.server.not_after,format:date_time),(field:tls.server.not_before,format:date_time),(field:zeek.kerberos.valid.from,format:date_time),(field:zeek.kerberos.valid.until,format:date_time),(field:zeek.ocsp.revoke.time,format:date_time),(field:zeek.ocsp.update.next,format:date_time),(field:zeek.ocsp.update.this,format:date_time),(field:zeek.pe.compile_time,format:date_time),(field:zeek.smb_files.times.accessed,format:date_time),(field:zeek.smb_files.times.changed,format:date_time),(field:zeek.smb_files.times.created,format:date_time),(field:zeek.smb_files.times.modified,format:date_time),(field:zeek.smtp.date,format:date_time),(field:zeek.snmp.up_since,format:date_time),(field:zeek.x509.certificate.valid.from,format:date_time),(field:zeek.x509.certificate.valid.until,format:date_time)),query:(bool:(filter:!((match_all:()),(exists:(field:err_type)),(match_phrase:(label:socket)),(range:(%27@timestamp%27:(format:strict_date_optional_time,gte:%272020-09-04T21:00:43.517Z%27,lte:%272020-09-05T21:00:43.517Z%27)))),must:!(),must_not:!(),should:!())),script_fields:(),sort:!((%27@timestamp%27:(order:desc,unmapped_type:boolean))),stored_fields:!(%27*%27),version:!t),index:%27filebeat*%27),title:%27Errors:%20Socket%27,type:search)'"
    os.system('curl -X POST' + params + ErrorsSocket_report_url)

    # Genraration of the report using Errors: VerifyBlockMiner
    ErrorsVBM_report_url = "'http://172.30.10.12/api/reporting/generate/csv?jobParams=(conflictedTypesFields:!(),fields:!(%27@timestamp%27,%27@version%27,_id,_index,_score,_type,agent.ephemeral_id,agent.hostname,agent.id,agent.type,agent.version,block-hash,ecs.version,err_type,filename,height,host.name,input.type,label,log.file.path,log.offset,message,miner_id,recv-date,recv-time,recv-timestamp,suricata.eve.timestamp,tags),indexPatternId:%279a6c4830-ed47-11ea-9640-a9f74e0dd150%27,metaFields:!(_source,_id,_type,_index,_score),searchRequest:(body:(_source:(excludes:!()),docvalue_fields:!((field:%27@timestamp%27,format:date_time),(field:aws.cloudtrail.user_identity.session_context.creation_date,format:date_time),(field:azure.auditlogs.properties.activity_datetime,format:date_time),(field:azure.enqueued_time,format:date_time),(field:azure.signinlogs.properties.created_at,format:date_time),(field:cef.extensions.agentReceiptTime,format:date_time),(field:cef.extensions.deviceCustomDate1,format:date_time),(field:cef.extensions.deviceCustomDate2,format:date_time),(field:cef.extensions.deviceReceiptTime,format:date_time),(field:cef.extensions.endTime,format:date_time),(field:cef.extensions.fileCreateTime,format:date_time),(field:cef.extensions.fileModificationTime,format:date_time),(field:cef.extensions.flexDate1,format:date_time),(field:cef.extensions.managerReceiptTime,format:date_time),(field:cef.extensions.oldFileCreateTime,format:date_time),(field:cef.extensions.oldFileModificationTime,format:date_time),(field:cef.extensions.startTime,format:date_time),(field:event.created,format:date_time),(field:event.end,format:date_time),(field:event.ingested,format:date_time),(field:event.start,format:date_time),(field:file.accessed,format:date_time),(field:file.created,format:date_time),(field:file.ctime,format:date_time),(field:file.mtime,format:date_time),(field:kafka.block_timestamp,format:date_time),(field:misp.campaign.first_seen,format:date_time),(field:misp.campaign.last_seen,format:date_time),(field:misp.intrusion_set.first_seen,format:date_time),(field:misp.intrusion_set.last_seen,format:date_time),(field:misp.observed_data.first_observed,format:date_time),(field:misp.observed_data.last_observed,format:date_time),(field:misp.report.published,format:date_time),(field:misp.threat_indicator.valid_from,format:date_time),(field:misp.threat_indicator.valid_until,format:date_time),(field:netflow.collection_time_milliseconds,format:date_time),(field:netflow.exporter.timestamp,format:date_time),(field:netflow.flow_end_microseconds,format:date_time),(field:netflow.flow_end_milliseconds,format:date_time),(field:netflow.flow_end_nanoseconds,format:date_time),(field:netflow.flow_end_seconds,format:date_time),(field:netflow.flow_start_microseconds,format:date_time),(field:netflow.flow_start_milliseconds,format:date_time),(field:netflow.flow_start_nanoseconds,format:date_time),(field:netflow.flow_start_seconds,format:date_time),(field:netflow.max_export_seconds,format:date_time),(field:netflow.max_flow_end_microseconds,format:date_time),(field:netflow.max_flow_end_milliseconds,format:date_time),(field:netflow.max_flow_end_nanoseconds,format:date_time),(field:netflow.max_flow_end_seconds,format:date_time),(field:netflow.min_export_seconds,format:date_time),(field:netflow.min_flow_start_microseconds,format:date_time),(field:netflow.min_flow_start_milliseconds,format:date_time),(field:netflow.min_flow_start_nanoseconds,format:date_time),(field:netflow.min_flow_start_seconds,format:date_time),(field:netflow.monitoring_interval_end_milli_seconds,format:date_time),(field:netflow.monitoring_interval_start_milli_seconds,format:date_time),(field:netflow.observation_time_microseconds,format:date_time),(field:netflow.observation_time_milliseconds,format:date_time),(field:netflow.observation_time_nanoseconds,format:date_time),(field:netflow.observation_time_seconds,format:date_time),(field:netflow.system_init_time_milliseconds,format:date_time),(field:package.installed,format:date_time),(field:process.parent.start,format:date_time),(field:process.start,format:date_time),(field:suricata.eve.flow.end,format:date_time),(field:suricata.eve.flow.start,format:date_time),(field:suricata.eve.timestamp,format:date_time),(field:suricata.eve.tls.notafter,format:date_time),(field:suricata.eve.tls.notbefore,format:date_time),(field:tls.client.not_after,format:date_time),(field:tls.client.not_before,format:date_time),(field:tls.server.not_after,format:date_time),(field:tls.server.not_before,format:date_time),(field:zeek.kerberos.valid.from,format:date_time),(field:zeek.kerberos.valid.until,format:date_time),(field:zeek.ocsp.revoke.time,format:date_time),(field:zeek.ocsp.update.next,format:date_time),(field:zeek.ocsp.update.this,format:date_time),(field:zeek.pe.compile_time,format:date_time),(field:zeek.smb_files.times.accessed,format:date_time),(field:zeek.smb_files.times.changed,format:date_time),(field:zeek.smb_files.times.created,format:date_time),(field:zeek.smb_files.times.modified,format:date_time),(field:zeek.smtp.date,format:date_time),(field:zeek.snmp.up_since,format:date_time),(field:zeek.x509.certificate.valid.from,format:date_time),(field:zeek.x509.certificate.valid.until,format:date_time)),query:(bool:(filter:!((match_all:()),(exists:(field:err_type)),(match_phrase:(label:VerifyBlockMiner)),(range:(%27@timestamp%27:(format:strict_date_optional_time,gte:%272020-09-04T21:02:59.602Z%27,lte:%272020-09-05T21:02:59.603Z%27)))),must:!(),must_not:!(),should:!())),script_fields:(),sort:!((%27@timestamp%27:(order:desc,unmapped_type:boolean))),stored_fields:!(%27*%27),version:!t),index:%27filebeat*%27),title:%27Errors:%20VerifyBlockMiner%27,type:search)'"
    os.system('curl -X POST' + params + ErrorsVBM_report_url)